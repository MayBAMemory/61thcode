>按照今天上课所说: 实现一个函数(客户端): (可以使用阻塞的recv实现, 也可以使用非阻塞的recv实现)
>
>recvn(int netfd, void *buf, int length)
>
>函数最终目的: 让我们最终可以向buf指向的内存中接收指定长度(length)的数据。
>
>```C
>int recvn(int sockfd, void *buf, long total){
>    char *p = (char *)buf;
>    long cursize = 0;
>    while(cursize < total){
>        ssize_t sret = recv(sockfd,p+cursize,total-cursize,0);
>        //ssize_t sret = recv(sockfd,p+cursize,total-cursize,MSG_NOTWAIT);
>        if(sret == 0){
>            return 1;
>        }
>        cursize += sret;
>    }
>    return 0;
>}
>```
>
>假设服务端有两个文件A.txt, B.txt; 当客户端要求(发送请求)下载A.txt, 服务器传输A.txt给客户端; 当客户端要求下载B.txt的时候, 服务器传输B.txt给客户端
>
>```C
>// 客户端
>int main(){
>    char *ip = "192.168.106.130";
>    char *port = "8080";
>
>    int socket_fd = socket(AF_INET, SOCK_STREAM, 0);
>
>    struct sockaddr_in sockaddr;
>    sockaddr.sin_family = AF_INET;
>    sockaddr.sin_port = htons(atoi(port));
>    sockaddr.sin_addr.s_addr = inet_addr(ip);
>
>    connect(socket_fd, (struct sockaddr *)&sockaddr, sizeof(sockaddr));
>
>    // 从标准输入中读取要下载的文件的名字
>    char file_name[60] = {0};
>    read(STDIN_FILENO, file_name, sizeof(file_name));
>    int name_len = strlen(file_name) -1;
>    // 发送给服务端
>    send(socket_fd, &name_len, sizeof(int), MSG_NOSIGNAL);
>    send(socket_fd, file_name, name_len, MSG_NOSIGNAL);
>
>    file_name[name_len] = 0;
>
>    // 创建文件
>    int file_fd = open(file_name, O_RDWR|O_CREAT, 0600);
>
>    // 接收服务端回传的内容, 写入文件
>    while(1){
>
>       int len;
>       int ret = recv(socket_fd, &len, sizeof(int), MSG_WAITALL);
>       printf("len: %d  \n", len);
>       if(ret == 0){
>           printf("break \n");
>           break;
>       }
>
>       char buf[4096] = {0};
>       ret = recv(socket_fd, buf, len, MSG_WAITALL);
>       if(ret == 0){
>           printf("break \n");
>           break;
>       }
>       write(file_fd, buf, ret);
>    }
>    close(file_fd);
>    close(socket_fd);
>    return 0;
>}
>```
>
>```C
>// 服务端的:  sendfile.c
>#include "head.h"
>
>int sendFile(int net_fd){
>
>    // 读取文件的名字长度 和 文件名
>    char file_name[60] = {0};
>    int name_len;
>
>    recv(net_fd, &name_len, sizeof(int), MSG_WAITALL);
>    recv(net_fd, file_name, name_len, MSG_WAITALL);
>
>    // 打开文件
>    int file_fd = open(file_name, O_RDONLY);
>
>    // 读取文件内容: 发送给客户端
>    while(1){
>       char buf[4096] = {0};
>       int len = read(file_fd, buf, sizeof(buf));
>       printf("len: %d \n", len);
>       if(len == 0){
>           break;
>       }
>
>       sleep(1);
>       int ret = send(net_fd, &len, sizeof(int), MSG_NOSIGNAL);
>       if(ret == -1){
>           printf("对端关闭\n");
>           break;
>       }
>       ret = send(net_fd, buf, len, MSG_NOSIGNAL);
>       if(ret == -1){
>           printf("对端关闭\n");
>           break;
>       }
>    }
>
>    return 0;
>}
>```